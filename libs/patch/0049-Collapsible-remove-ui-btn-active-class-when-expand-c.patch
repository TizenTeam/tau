From 70a01f2e8704e5b818451d2892d9da9ed66c37a6 Mon Sep 17 00:00:00 2001
From: Przemyslaw Ciezkowski <p.ciezkowski@samsung.com>
Date: Wed, 12 Jun 2013 11:15:52 +0200
Subject: [PATCH] Collapsible: remove ui-btn-active class when expand/collapse
 is cancelled

Change-Id: Icb8772fa56461ef43e735b72545f0e27a335ff34
---
 .../jquery-mobile-1.2.0/js/widgets/collapsible.js  |    8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js b/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js
index 9e29955..ce384be 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js
@@ -134,8 +134,7 @@ $.widget( "mobile.collapsible", $.mobile.widget, {
 							.toggleClass( "ui-icon-" + expandedIcon, !isCollapse )
 							// logic or cause same icon for expanded/collapsed state would remove the ui-icon-class
 							.toggleClass( "ui-icon-" + collapsedIcon, ( isCollapse || expandedIcon === collapsedIcon ) )
-						.end()
-						.find( "a" ).first().removeClass( $.mobile.activeBtnClass );
+						.end();
 
 					$this.toggleClass( "ui-collapsible-collapsed", isCollapse );
 					collapsibleContent.toggleClass( "ui-collapsible-content-collapsed", isCollapse ).attr( "aria-hidden", isCollapse );
@@ -153,9 +152,12 @@ $.widget( "mobile.collapsible", $.mobile.widget, {
 			.trigger( o.collapsed ? "collapse" : "expand" );
 
 		collapsibleHeading
-			.bind( "tap", function( event ) {
+			.bind( "vmousedown", function() {
 				collapsibleHeading.find( "a" ).first().addClass( $.mobile.activeBtnClass );
 			})
+			.bind( "vmousecancel vmouseup", function() {
+				collapsibleHeading.find( "a" ).first().removeClass( $.mobile.activeBtnClass );
+			})
 			.bind( "click", function( event ) {
 
 				var type = collapsibleHeading.is( ".ui-collapsible-heading-collapsed" ) ? "expand" : "collapse";
-- 
1.7.9.5

