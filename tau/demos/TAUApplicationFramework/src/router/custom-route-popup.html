<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width,user-scalable=no"/>
	<link rel="stylesheet"  href="../../lib/tau/theme/default/tau.css">
	<link rel="stylesheet"  href="../../lib/highlightjs/styles/github.css">
	<link rel="stylesheet"  href="../css/custom.css">
	<title>TAU Application Framework</title>
</head>
	<body>
		<div class="ui-page" id="custom-route-popup-template">
			<header>
				<h2 class="ui-title">Loading popups from templates</h2>
			</header>
			<div class="ui-content">
				<pre><code class="javascript">
var controller = tau.Controller.getInstance();
controller.addRoute("page-template", function (deferred) {
	tau.template.render("templates/popup-template.html", {}, function (status, data) {
		if (status.success) {
			deferred.resolve(data);
		} else {
			deferred.reject();
		}
	});
});
				</code></pre>
			</div>
			<script>
				var controller = tau.Controller.getInstance();
				controller.addRoute("popup-template", function (deferred) {
					tau.template.render("templates/popup-template.html", {}, function (status, data) {
						var page = document.getElementById("custom-route-popup-template"),
							popup = document.getElementById("popup-template");
						// check if popup exists and remove it
						if (popup) {
							tau.engine.getBinding(popup).destroy();
							popup.parentNode.removeChild(popup);
						}
						// add popup to page
						page.appendChild(data);
						// resolve or reject deferred
						if (status.success) {
							deferred.resolve(data); // @TODO THIS HAS TO BE FIXED IN TEMPLATES!!
						} else {
							deferred.reject();
						}
					});
				});
			</script>
			<footer>
				<a href="#popup-template" rel="popup" class="ui-btn ui-button">Test it</a>
			</footer>
		</div>
		<script type="text/javascript" src="../../lib/tau/js/tau.js" data-build-remove="false"></script>
		<script src="../../lib/highlightjs/highlight.min.js"></script>
		<script src="../js/highlighting.js"></script>
	</body>
</html>
